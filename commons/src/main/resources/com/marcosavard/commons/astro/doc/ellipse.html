<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>ellipse</title></head><body>
  <img src="http://www.stargazing.net/kepler/banner.gif" alt="" style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;" border="0" height="30" width="400"><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;"></span>
<h1 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig00">Planet positions using elliptical orbits</a></h1>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/index.html" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Root</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Contents</h2>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li><a href="http://www.stargazing.net/kepler/ellipse.html#twig01">Overview</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig01a">Frameworks and coordinates</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig02">The osculating elements</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig02a">Outline of steps in the calculation</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig03">Position of the planet in its orbit</a><ul><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig03a">Find the number of days</a><span>&nbsp;</span>since the date of the elements</li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig03b">Find the mean anomaly</a><span>&nbsp;</span>from the Mean Longitude and the daily motion</li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig03c">Find the true anomaly</a><span>&nbsp;</span>using the Equation of Centre</li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig03d">Find the radius vector</a><span>&nbsp;</span>of the planet</li></ul></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig04">Heliocentric coordinates of the planet</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig05">Heliocentric coordinates of Earth</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig06">Geocentric ecliptic coordinates of the planet</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig07">Geocentric equatorial coordinates of the planet</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig08">QBASIC program</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig10">Accuracy</a></li><li><a href="http://www.stargazing.net/kepler/ellipse.html#twig11">Books</a></li>
</ul>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig01">Overview</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">You
can calculate the position of one of the major planets to within an
accuracy of one arc minute on the sky using an ordinary scientific
calculator in about 20 minutes.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">You
will need the current 'osculating elements' for the elliptical orbit of
the planet and for the Earth. Osculating elements allow for the effects
of the mutual interactions of the planets for a given date, and
positions calculated from a given set of elements will be less accurate
further from that date. The advantage is in conceptual simplicity - you
are using a simple 2- body model of an orbit, with the Sun at one focus.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I
shall calculate the position of Mars as an example, and the positions
will be within a few arc minutes of the correct positions for about a
year either side of the date of the elements used.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">You
might want to find a position 'by hand' once, so as to understand the
calculation method and get a feel for the size of the numbers involved.
After that, it is fairly easy to write a simple program for a
programmable calculator, or devise a spreadsheet. A very simple<span>&nbsp;</span><code>QBASIC</code><span>&nbsp;</span>program is given below.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
image of an elliptical orbit moving under Kepler's laws seems so simple
that we forget how confused and difficult the development of this idea
was. To mention just one detail - in the period after Kepler and before
Newton, there was no good theory of atmospheric refraction, so that
reported positions of the planets had systematic errors which depended
on the angle above the horizon at which the observations were made.
Observations would not fit ellipses in a consistent way, and Kepler,
Horrocks and Streete (to name a few) struggled with 'anomalies' in the
sense of Kuhn [Kuhn 1962].</p>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig01a">Frameworks and coordinates</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
positions of objects in the sky as viewed from Earth are referred to a
coordinate system whose alignment is changing with time in a complex
way. A few of the important motions and effects are summarised below;</p>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li>The Earth is rotating on its axis once every siderial day</li><li>The rotation axis is moving in a circle with a period of roughly 26,000 years (precession)</li><li>The axis is 'nodding' up and down with a period of roughly 19 years (nutation)</li><li>The finite speed of light (sometimes referred to as 'aberration' in some books)</li>
</ul>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
'fixed' stars provide a reference system which allows us to account for
the daily rotation of the Earth on its axis. We use the Equatorial
coordinate system to refer positions to a frame in which the stars
appear still, and the right ascension (RA) and declination (DEC) are
used to give the coordinates of the planet with respect to the fixed
stars. The 'zero' of RA is refered to the 'vernal equinox', in the same
way that the 'zero' of longitude is taken as the Greenwich Meridian.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
presession of the equinoxes means that the 'zero' of RA is changing
slowly with time, which means that star coordinates must always be
referred to an epoch, or date. By using orbital elements referred to
the fundamental epoch J2000, the orbits of the planets are described in
a coordinate system which is based on the position the vernal equinox<span>&nbsp;</span><em>will have</em><span>&nbsp;</span>at
J2000. A further advantage of this dodge is that our positions for the
planets will correspond exactly to the positions found in most recent
star charts. You should be able to plot the path of Mars directly onto
a star chart such as<span>&nbsp;</span><cite>The Cambridge Star Atlas</cite>.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Nutation
(which is a small effect anyway) can also be spirited away by referring
our positions to the 'mean ecliptic of J2000'. The word 'mean'
indicates that no allowance for nutation has been made. Our observation
platform (the Earth) is nodding, so the stars and planets will appear
to nod together. Our J2000 elements will give is positions which match
the co-ordinates of the stars found in star maps.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">There
is a problem with this use of J2000 equinox and mean ecliptic. If I
just dial the values for RA and DEC into a computerised telescope, then
the planet will<span>&nbsp;</span><em>not</em><span>&nbsp;</span>appear
in the centre of the field of view - as the RA and DEC will not be
referred to the 'equinox and true ecliptic of date'. The effect will be
very small for 10 years either side of J2000.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">A
larger effect with the outlying planets will be caused by the finite
speed of light. Indeed, one of the first estimates of the speed of
light was obtained by careful timings of the eclipses of the Galilean
moons of Jupiter. Light takes about 50 minutes to reach us from
Jupiter, and so we see Jupiter in a position it was about 50 minutes
before we looked! The problem is that we don't know how far Jupiter is
until we calculate the planet's position, but we can't calculate the
position accurately until we allow for the light travel time.... A
series of approximations is needed. A position which has been corrected
for the light travel time and which is referred to equinox and mean
ecliptic of J2000 is called 'astrometric'. I shall be adding
corrections for this later.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">There
are approximate and accurate formulas for converting positions at one
time to positions at another [Duffett-Smith section 34, 35] [Meeus,
Chapter 20, 21].</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For more information on frames and rectangular coordinates, including some rather nice diagrams, see;</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a href="http://ph1.rmc.ca/%7Edeboer/om/frame/frame.html">http://ph1.rmc.ca/~deboer/om/frame/frame.html</a></p>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig02">The osculating elements</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">An
elliptical orbit can be specified by the values of various numbers. The
plane of the orbit must be specified, as must the size and the
eccentricity, and the position of the perihelion, and the position of
the planet at the date of the elements. There are a number of different
sets of numbers which can be used, and one set can be converted into
another set. The Astronomical Almanac provides 7 numbers to specify an
orbit;</p>
<dl style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<dt><strong>Inclination (i)</strong></dt><dd>angle between the plane of the Ecliptic and the plane of the orbit.</dd><dt><strong>Longitude of the Ascending Node (o)</strong></dt><dd>states
the position in the orbit where the elliptical path of the planet
passes through the plane of the ecliptic, from below the plane to above
the plane.</dd><dt><strong>Longitude of Perihelion (p)</strong></dt><dd>states the position in the orbit where the planet is closest to the Sun.</dd><dt><strong>Mean distance (a)</strong></dt><dd>the value of the semi-major axis of the orbit - measured in Astronomical Units for the major planets.</dd><dt><strong>Daily motion (n)</strong></dt><dd>states
how far in degrees the planet moves in one (mean solar) day. This
figure can be used to find the mean anomaly of the planet for a given
number of days either side of the date of the elements. The figures
quoted in the Astronomical Almanac do<span>&nbsp;</span><em>not</em><span>&nbsp;</span>tally with the period of the planet as calculated by applying Kepler's 3rd Law to the semi-major axis.</dd><dt><strong>Eccentricity (e)</strong></dt><dd>eccentricity of the ellipse which describes the orbit</dd><dt><strong>Mean Longitude (L)</strong></dt><dd>Position of the planet in the orbit on the date of the elements.</dd>
</dl>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I
use the osculating elements taken from page E3 of the Astronomical
Almanac for 1997. As explained in the previous section, these elements
are referred to the 'mean ecliptic and equinox' of J2000.0, so that
positions calculated from these elements will show the correct
relationship with the stars when plotted on a J2000 star chart, apart
from the effect of light travel time. The osculating elements include
the effects of the other planets (perturbations) at the date 8th August
1997, and will give less accurate positions the further we go from that
date. This has nothing to do with the<span>&nbsp;</span><em>coordinate system</em><span>&nbsp;</span>we happen to want to use, the J2000 mean ecliptic and equinox.</p>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Values of the Osculating Elements for 8th August 1997</h3>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">JD = 2450680.5<br>Equinox and mean ecliptic of J2000.0<br><br>       Earth          Mars<br><br>i     0.00041       1.84992   <br>o   349.2          49.5664<br>p   102.8517      336.0882<br>a     1.0000200     1.5236365<br>n     0.9855796     0.5240613<br>e     0.0166967     0.0934231<br>L   328.40353     262.42784<br><br>The values for the other planets can be found in<br>the QBASIC program below<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig02a">Outline of steps in the calculation</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
sections below deal with calculating the RA and DEC of a planet from
the osculating elements. As an example, I shall find the position of
Mars at 0h UT on the 21st of June 1997. The main steps in the
calculation are;</p>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li>Finding the position of the planet in its orbit<ul><li>Find the number of days since the date of the elements</li><li>Find the mean anomaly from the Mean Longitude and the daily motion</li><li>Find the true anomaly using the Equation of Centre</li><li>Find the radius vector of the planet</li></ul></li><li>Refer that position to the Ecliptic - hence find the heliocentric ecliptic coordinates of the planet</li><li>Repeat most of above to find the heliocentric coordinates of the Earth</li><li>Transform the heliocentric coordinates to geocentric coordinates by a change of origin</li><li>Transform the geocentric ecliptic coordinates to geocentric equatorial coordinates by a rotation about the X axis</li><li>Calculate the RA and DEC and Earth - planet distance from the rectangular coordinates</li>
</ul>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I
have used rectangular coordinates throughout, as most people with a
science and engineering background will be more familiar with the ideas
of coordinate transformations acting on Cartesian coordinates than with
spherical trigonometry. Those who know matrix algebra might feel
happier recasting the calculations below in matrix form [Duffett-Smith,
section 31]. The method shown here is<span>&nbsp;</span><em>not</em><span>&nbsp;</span>that used by Thomas Streete or Edmond Halley!</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The method used here was adapted from Paul Schlyter's page 'How to compute planetary positions' at</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a href="http://hotel04.ausys.se/pausch/comp/ppcomp.html">http://hotel04.ausys.se/pausch/comp/ppcomp.html</a></p>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Notation</h3>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">Elements<br><br>i - inclination<br>o - longitude of ascending node at date of elements <br>p - longitude of perihelion at date of elements <br>a - mean distance (au)<br>n - daily motion <br>e - eccentricity of orbit<br>l - mean longitude at date of elements<br><br>Calculated quantities<br><br>M - mean anomaly (degrees)<br>V - True anomaly (degrees)<br>r - radius vector (au) referred to current coordinate origin<br>X - recangular coordinate (au)<br>Y - recangular coordinate (au)<br>Z - recangular coordinate (au)<br>alpha - right ascension (hours or decimal degrees according to<br>context)<br>delta - declination (decimal degrees)<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig03">Position of the planet in its orbit</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig03a">Number of days from date of elements</a></h3>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">To
find the number of days since the date of the osculating elements (d),
you can find the 'day number' (dele) of the elements, and then the 'day
number' you want the position for (dpos). Then you just subtract,</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">d = dpos - dele</pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
'day number' can be the Julian day, or the number of days since the
fundamental epoch J2000. I use the second alternative as less precision
is needed for the numbers!</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
following tables show the days from the beginning of the year to the
beginning of each month, and the days from J2000 to the beginning of
each year.</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">        Days to beginning of month<br><br>        Month   Normal year    Leap year<br>        Jan         0             0<br>        Feb        31            31<br>        Mar        59            60<br>        Apr        90            91<br>        May       120           121<br>        Jun       151           152<br>        Jul       181           182<br>        Aug       212           213<br>        Sep       243           244<br>        Oct       273           274<br>        Nov       304           305<br>        Dec       334           335<br><br>        Days since J2000 to beginning of each year<br><br>                  Days<br>        1995    -1827.5<br>        1996    -1462.5<br>        1997    -1096.5<br>        1998     -731.5<br>        1999     -366.5<br>        2000       -1.5<br>        2001      364.5<br>        2002      729.5<br>        2003     1094.5<br>        2004     1459.5<br>        2005     1825.5<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">we can find the day number corresponding to the date of the elements (0h 20th August 1997) as follows;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">        dele = 212 + 20 - 1096.5 = -864.5<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">and the day number of the date we want the position for (0h 21st June 1997) is;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">        dpos = 151 + 21 - 1096.5 = -924.5<br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">so the number of days<span>&nbsp;</span></span><em style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">after</em><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;"><span>&nbsp;</span>the date of the elements is</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">         dpos  -  dele  =  d<br>        -924.5 - -864.5 = -60 days<br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">i.e. 60 days<span>&nbsp;</span></span><em style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">before</em><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;"><span>&nbsp;</span>the elements. You must take dates before an epoch as negative in the calculations below.</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For
fast moving planets such as Mercury and Mars, you need to include the
time of day which you want the position for. Just add the Universal
Time in decimal hours divided by 24 to the day number of your position
(dele above);</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">      day fraction = (H + M/60)/24 <br>    <br>      H is hours UT<br>      M is minutes UT<br></pre>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig03b">Finding the Mean Anomaly of the planet</a></h3>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The Mean Anomaly of the planet is given by the very simple formula;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">        M = n * d + L - p <br><br>        n is daily motion<br>        d is the number of days since the date of the elements<br>        L is the mean longitude<br>        p is the longitude of perihelion <br><br>        M should be in range 0 to 360 degrees, add or subtract<br>          multiples of 360 to bring M into this range.<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For our case of Mars and -60 days since the date of the elements;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">        n = 0.5240613<br>        d = -60<br>        L = 262.42784<br>        p = 336.0882<br><br>        M = 0.5240613 * -60 + 262.42784 - 336.0882<br>          = -105.104038 + 360<br>          = 254.895962 <br></pre>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig03c">Finding the true anomaly of the planet</a></h3>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Kepler's
second law states that the radius vector of the planet sweeps out equal
areas in equal times. This means that the planet must speed up and slow
down in its orbit. The mean anomaly tells us where the planet would be
given mean motion in a circular orbit of radius equal to the semimajor
axis. We want the true angle from the perihelion - known as the true
anomaly.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For
this 'manual' calculation, I shall use an approximation to the true
anomaly known as the Equation of Centre. This approximation takes the
form of a power series in the eccentricity and the sine of the mean
anomaly. The Astronomical Almanac (page E4) quotes the series as far as
the third power of the eccentricity. In our notation;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">     v = M + 180/pi * [ (2 * e - e^3/4) * sin(M) <br>                             + 5/4 * e^2 * sin(2*M)<br>                             + 13/12 * e^3 * sin(3*M) ]<br><br>         v is true anomaly<br>         M is mean anomaly<br>         e is eccentricity<br>         pi is 3.14159...<br><br>         e^3 means the third power of e. Note how the third<br>         power is involved the first term as well as the last.<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For our Mars position, we have</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    M = 254.895962 degrees<br>    e = 0.0934231<br><br>    v = 254.895962 + 57.29577951 * [ -0.180195 + 0.005489 +<br>    0.0006212 ]<br>      = 254.895962 - 9.974293328<br>      = 244.921657 degrees<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">As
you can see, the correction is large for Mars, nearly 10 degrees. I
usually do a rough check on the size of this correction - find a rough
value for<span>&nbsp;</span><code>2 * e * sin(M)</code><span>&nbsp;</span>then multiply by 60.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For more information about the true anomaly, see my page at;</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a href="http://www.stargazing.net/kepler/kepler.html">http://www.geocities.com/CapeCanaveral/Lab/4749/kepler.html</a></p>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig03d">Finding the radius vector of the planet</a></h3>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The distance from the planet to the focus of the ellipse is given by a simple formula based on the geometry of the ellipse;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">      r = a * (1 - e^2) / [1 + e * cos(v)]<br>  <br>          a is the semi-major axis<br>          e is the eccentricity<br>          v is the true anomaly<br><br>          the radius vector r will be in the same units as a<br>          a.u. in this case.<br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">In our Mars calculation we have;</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">      a = 1.5236365<br>      e = 0.0934231<br>      v = 244.921657<br>    <br>      r = 1.5236365 * (1 - 0.0934231^2) / [ 1 + 0.0934231 * cos<br>      (244.921657) ]<br>        = 1.57261067<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig04">Heliocentric coordinates of the planet</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Having
found the true anomaly and the radius vector of the planet, we can go
on to find the position of the planet with respect to the plane of the
ecliptic. The formulas below are a combination of 'resolving' to find
components and rotations around various axes to transform the
coordinates to the Ecliptic frame. We might expect the formulas to
involve the inclination of the planet's orbit (i), and various angles
within the plane of the orbit, as well as the longitude of the
ascending node (o).</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;"> <br>    X = r * [cos(o) * cos(v + p - o) - sin(o) * sin(v + p - o) *<br>    cos(i)]<br>    Y = r * [sin(o) * cos(v + p - o) + cos(o) * sin(v + p - o) *<br>    cos(i)]<br>    Z = r * [sin(v + p - o) * sin(i)]<br><br>    r is radius vector<br>    v is true anomaly<br>    o is longitude of ascending node<br>    p is longitude of perihelion<br>    i is inclination of plane of orbit<br><br>    the quantity v + o - p is the angle of the planet measured<br>    in the plane of the orbit from the ascending node<br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">In the case of Mars we have;</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    r = 1.57261067<br>    v = 244.921657<br>    o = 49.5664<br>    p = 336.0882<br>    i = 1.84992<br>    v + p - o = 531.443457 - 360 = 171.443457<br> <br>    and I get the following rectangular coordinates;<br><br>    X = 1.57261067 * [ -0.64134752 - 0.11319000 ] = -1.18659376<br>    Y = 1.57261067 * [ -0.75268604 + 0.09644689 ] = -1.03200869<br>    Z = 1.57261067 * [  0.00480302 ]              =  0.00755328<br><br>    as a check, SQRT(X^2 + Y^2 + Z^2) should be same as r<br>    I get a difference in the 7th decimal place due to<br>    rounding.<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig05">Heliocentric coordinates of Earth</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">We
must find the true anomaly and radius vector of the Earth using the
same method as for the planet. The calculations are shown in a more
compact form - see if you can follow the logic.</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    M = 0.9855796 * -60 + 328.40353 - 102.8517<br>      = 166.417054 degrees<br><br>    V = 166.417054 + 57.29577951 * [ 0.00784226 - 0.00015852 +<br>    0.00000328 ]<br>      = 166.417054 + 0.440433803<br>      = 166.8574877<br><br>        (note how small the difference between M and v is<br>        compared<br>         to the difference for Mars)<br><br>    r = 1.0000200 * (1 - 0.0166967^2) / [1 + 0.0166967 *<br>    cos(166.8574877)]<br>      = 1.01626505 a.u.<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">To
find the heliocentric coordinates for Earth, we can make some
simplifications to the formulas as the inclination of the Earth's orbit
is very small. We have;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">   Xe = r * cos(v + p)<br>   Ye = r * sin(v + p)<br>   Ze = 0<br><br>   r is radius vector of Earth<br>   v is true anomaly for Earth<br>   p is longitude of perihelion for Earth<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For the problem in hand we have;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">   r = 1.01626505    a.u.<br>   v = 166.8574877   degs<br>   p = 102.8517      degs<br><br>   Xe = 1.01626505 * -0.0050756103 = -0.00515816<br>   Ye = 1.01626505 * -0.999987119  = -1.01625196<br>   Ze                              =  0<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig06">Geocentric ecliptic coordinates of the planet</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Changing
the origin of the coordinate system from the Sun to the Earth is very
easy, we just subtract the Earth's coordinates from those of the planet;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">   X' = X - Xe<br>   Y' = Y - Ye<br>   Z' = Z - Ze  <br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">We then have the geocentric ecliptic coordinates of the planet. For the case of Mars we have,</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">   X' = -1.18659376 - -0.00515816 = -1.18143560<br>   Y' = -1.03200869 - -1.01625196 = -0.01575673<br>   Z' =  0.00755328 - 0           =  0.00755328<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig07">Geocentric equatorial coordinates of the planet</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">To
change the coordinate system from geocentric ecliptic to geocentric
equatorial is just a matter of a rotation around the X axis by an angle
equal to the 'obliquity of the Ecliptic. The X axis points towards the
'First point of Aries', which is the direction in space associated with
the equinox. As we are using elements referred to the equinox of
J2000.0, we use the obliquity for that epoch, which is 23.439292
degrees. the formulas are given below;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    Xq = X'<br>    Yq = Y' * cos(ec) - Z' * sin(ec)<br>    Zq = Y' * sin(ec) + Z' * cos(ec)<br><br>    Xq are the equatorial coordinates<br>    X' are the geocentric ecliptic coordinates      <br>    ec is the obliquity of the ecliptic <br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">For Mars, we have</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    Xq = -1.18143560<br>    Yq = -0.01746127<br>    Zq = +0.00066224<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">rectangular
coordinates are not much use with star charts, so we calculate the
familiar right ascension and declination using the formulas;</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    alpha = arctan(Yq/Xq)<br>     <br>    If Xq is negative then add 180 degrees to alpha  <br>    If Xq is positive and Yq is negative then add 360 degrees to<br>    alpha<br><br>    alpha is usually expressed in hours, so divide by 15<br><br>    delta = arctan( Zq / SQRT(Xq^2 + Yq^2)) <br><br>    distance = SQRT( Xq^2 + Yq^2 + Zq^2)          <br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">In the case of Mars on the 21st June 1997 we have</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">    alpha = arctan(-0.01746127/-1.18143560)<br>          = 0.84675309 + 180 = 180.84675309 /15<br>          = 12.05645 hrs<br><br>    delta = arctan(+0.00066224/ 1.39609497)<br>          = 0.02718 degs  <br><br>    distance = SQRT( -1.18143560^2 + -0.01746127^2 +<br>    +0.00066224^2) <br>             = 1.18156481 a.u.      <br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">These positions compare well with those from the<span>&nbsp;</span><code>QBASIC</code><span>&nbsp;</span>program,
which uses an iterative routine to find the true anomaly. Differences
in the heliocentric coordinates of Mars are in the fourth decimal
place. Differences in the RA are five<span>&nbsp;</span><em>arc</em><span>&nbsp;</span>minutes and about 20 arc seconds in declination.</p>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig08">QBASIC program</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The very simple<span>&nbsp;</span><code>QBASIC</code><span>&nbsp;</span>program
below will prompt you for the Year, Month, Day and Hour and Minute (UT)
for which you want the position, and a number representing the planet
you wish to calculate the position for. The program will then print</p>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li>The number of days from J2000.0</li><li>The heliocentric rectangular coordinates of the Earth</li><li>The heliocentric rectangular coordinates of the planet</li><li>The RA of the planet in hh.mm form</li><li>The DEC of the planet in dd.mm form</li><li>The distance of the planet from Earth in A.U.</li>
</ul>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I have used the<span>&nbsp;</span><code>DEF FN</code><span>&nbsp;</span>statements
to define functions. By doing this the code will compile using the
FirstBas shareware compiler available from PowerBasic.</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">'*********************************************************<br>'   This program will calculate the positions of the<br>'   major planets using the current 'osculating elements'<br>'   from the Astronomical Almanac.<br>'<br>'   A simple elliptical orbit<br>'   is assumed for both the planet and the Earth - no<br>'   corrections are made from within the program as the<br>'   osculating elements will already take account of<br>'   perturbations.<br>'<br>'   The method used here is based on finding the rectangular<br>'   coordinates of the planet and of the Earth, and then<br>applying<br>'   successive coordinate transformations to find the<br>rectangular<br>'   gocentric equatorial coordinates of the planet.<br>'<br>'   QBASIC program by Keith Burnett (kburnett@geocity.com)<br>'<br>'<br>'   Work in double precision and define some constants<br>'<br>DEFDBL A-Z<br>pr$ = "\         \#####.##"<br>pr2$ = "\         \###.######"<br>pi = 4 * ATN(1)<br>tpi = 2 * pi<br>twopi = tpi<br>degs = 180 / pi<br>rads = pi / 180<br>'<br>'   list of elements el()<br>'   List of the osculating elements of the 9 major<br>'   planets in the format used in the Astronomical<br>'   Ephemeris. Item el(64) in list is the Julian date<br>'   of the elements. Item el(65) is the epoch of the<br>'   mean ecliptic and equinox the elements are referred to.<br>'<br>'   If you want positions referred to<br>'   the mean equator and equinox of the date of the<br>'   osculating elements, then use the elements listed<br>'   on pages E4 and E5 of the AA. If you want the positions<br>'   referred to the mean equator and equinox of J2000<br>'   then use the elements found on page E3 of the AA.<br>'<br>'<br>DIM el(9 * 7 + 2)<br>'   below are the osculating elements for JD = 2450680.5<br>'   referred to mean ecliptic and equinox of J2000<br>'Mercury<br>el(1) = 7.00507# * rads<br>el(2) = 48.3339# * rads<br>el(3) = 77.45399999999999# * rads<br>el(4) = .3870978#<br>el(5) = 4.092353# * rads<br>el(6) = .2056324#<br>el(7) = 314.42369# * rads<br>'Venus<br>el(8) = 3.39472# * rads<br>el(9) = 76.6889# * rads<br>el(10) = 131.761# * rads<br>el(11) = .7233238#<br>el(12) = 1.602158# * rads<br>el(13) = .0067933#<br>el(14) = 236.94045# * rads<br>'Earth<br>el(15) = .00041# * rads<br>el(16) = 349.2# * rads<br>el(17) = 102.8517# * rads<br>el(18) = 1.00002#<br>el(19) = .9855796# * rads<br>el(20) = .0166967#<br>el(21) = 328.40353# * rads<br>'Mars<br>el(22) = 1.84992# * rads<br>el(23) = 49.5664# * rads<br>el(24) = 336.0882# * rads<br>el(25) = 1.5236365#<br>el(26) = .5240613# * rads<br>el(27) = .0934231#<br>el(28) = 262.42784# * rads<br>'Jupiter<br>el(29) = 1.30463# * rads<br>el(30) = 100.4713# * rads<br>el(31) = 15.6978# * rads<br>el(32) = 5.202597#<br>el(33) = 8.309618000000001D-02 * rads<br>el(34) = .0484646#<br>el(35) = 322.55983# * rads<br>'Saturn<br>el(36) = 2.48524# * rads<br>el(37) = 113.6358# * rads<br>el(38) = 88.863# * rads<br>el(39) = 9.571899999999999#<br>el(40) = .03328656# * rads<br>el(41) = .0531651#<br>el(42) = 20.95759# * rads<br>'Uranus<br>el(43) = .77343# * rads<br>el(44) = 74.0954# * rads<br>el(45) = 175.6807# * rads<br>el(46) = 19.30181#<br>el(47) = .01162295# * rads<br>el(48) = .0428959#<br>el(49) = 303.18967# * rads<br>'Neptune<br>el(50) = 1.7681# * rads<br>el(51) = 131.7925# * rads<br>el(52) = 7.206# * rads<br>el(53) = 30.26664#<br>el(54) = .005919282# * rads<br>el(55) = .0102981#<br>el(56) = 299.8641# * rads<br>'Pluto<br>el(57) = 17.12137# * rads<br>el(58) = 110.3833# * rads<br>el(59) = 224.8025# * rads<br>el(60) = 39.5804#<br>el(61) = .003958072# * rads<br>el(62) = .2501272#<br>el(63) = 235.7656# * rads<br>'Dates<br>el(64) = 2450680.5# 'date of elements<br>el(65) = 2451545#   'date of mean ecliptic and equinox of<br>elements<br>'<br>'   Get the days to J2000<br>'   h is UT in decimal hours<br>'   FNday only works between 1901 to 2099 - see Meeus chapter 7<br>'<br>DEF FNday (y, m, d, h) = 367 * y - 7 * (y + (m + 9) \ 12) \ 4 +<br>275 * m \ 9 + d - 730531.5 + h / 24<br>'<br>'   define some arc cos and arc sin functions and a modified<br>inverse<br>'   tangent function<br>'<br>DEF FNacos (x)<br>    s = SQR(1 - x * x)<br>    FNacos = ATN(s / x)<br>END DEF<br>DEF FNasin (x)<br>    c = SQR(1 - x * x)<br>    FNasin = ATN(x / c)<br>END DEF<br>'<br>'   the atn2 function below returns an angle in the range 0 to<br>two pi<br>'   depending on the signs of x and y.<br>'<br>DEF FNatn2 (y, x)<br>    a = ATN(y / x)<br>    IF x &lt; 0 THEN a = a + pi<br>    IF (y &lt; 0) AND (x &gt; 0) THEN a = a + tpi<br>    FNatn2 = a<br>END DEF<br>'<br>'   the function below returns the true integer part,<br>'   even for negative numbers<br>'<br>DEF FNipart (x) = SGN(x) * INT(ABS(x))<br>'<br>'   the function below returns an angle in the range<br>'   0 to two pi<br>'<br>DEF FNrange (x)<br>    b = x / tpi<br>    a = tpi * (b - FNipart(b))<br>    IF a &lt; 0 THEN a = tpi + a<br>    FNrange = a<br>END DEF<br>'<br>DEF FNkep (m, ecc, eps)<br>'<br>'   returns the true anomaly given<br>'   m - the mean anomaly in radians<br>'   ecc - the eccentricity of the orbit<br>'   eps - the convergence paramter (8 or 9 is usually fine<br>'   12 or 14 for very accurate work)<br>'<br>e = m<br>delta = .05#<br>DO WHILE ABS(delta) &gt;= 10 ^ -eps<br>      delta = e - ecc * SIN(e) - m<br>      e = e - delta / (1 - ecc * COS(e))<br>LOOP<br>v = 2 * ATN(((1 + ecc) / (1 - ecc)) ^ .5 * TAN(.5 * e))<br>IF v &lt; 0 THEN v = v + tpi<br>FNkep = v<br>END DEF<br>'<br>DEF FNdegmin (x)<br>'   cosmetic function returns angular values as a made up<br>decimal<br>'   number  - ddd.mm - the digits after the decimal point are<br>the<br>'   minutes.<br>a = FNipart(x)<br>b = x - a<br>e = FNipart(60 * b)<br>'   deal with carry on minutes<br>IF e &gt;= 60 THEN<br>    e = 0<br>    a = a + 1<br>END IF<br>FNdegmin = a + e / 100<br>END DEF<br>'<br>CLS<br>'<br>'    get the date and planet number from the user<br>'<br>INPUT "   year  : ", y<br>INPUT "   month : ", m<br>INPUT "   day   : ", day<br>INPUT " hour UT : ", h<br>INPUT "  minute : ", mins<br>h = h + mins / 60<br>INPUT "  planet : ", p<br>d = FNday(y, m, day, h)<br>PRINT USING pr$; "    days : "; d<br>'<br>'   get the osculating elements from the list<br>'   using letters instead of the array element<br>'   makes the program easier to read.<br>'<br>q = 7 * (p - 1)<br>ip = el(q + 1)<br>op = el(q + 2)<br>pp = el(q + 3)<br>ap = el(q + 4)<br>np = el(q + 5)<br>ep = el(q + 6)<br>lp = el(q + 7)<br>ie = el(15)<br>oe = el(16)<br>pe = el(17)<br>ae = el(18)<br>ne = el(19)<br>ee = el(20)<br>le = el(21)<br>eldate = el(64) - 2451545#<br>'<br>'   now find position of Earth in orbit<br>'<br>me = FNrange(ne * (d - eldate) + le - pe)<br>ve = FNkep(me, ee, 12)<br>re = ae * (1 - ee * ee) / (1 + ee * COS(ve))<br>xe = re * COS(ve + pe)<br>ye = re * SIN(ve + pe)<br>ze = 0<br>PRINT<br>PRINT "heliocentric coordinates of Earth"<br>PRINT USING pr2$; "       X :"; xe<br>PRINT USING pr2$; "       Y :"; ye<br>PRINT USING pr2$; "       Z :"; ze<br>'<br>'   and position of planet in its orbit<br>'<br>mp = FNrange(np * (d - eldate) + lp - pp)<br>vp = FNkep(mp, ep, 12)<br>rp = ap * (1 - ep * ep) / (1 + ep * COS(vp))<br>'<br>'   heliocentric rectangular coordinates of planet<br>'<br>xh = rp * (COS(op) * COS(vp + pp - op) - SIN(op) * SIN(vp + pp -<br>op) * COS(ip))<br>yh = rp * (SIN(op) * COS(vp + pp - op) + COS(op) * SIN(vp + pp -<br>op) * COS(ip))<br>zh = rp * (SIN(vp + pp - op) * SIN(ip))<br>PRINT<br>PRINT "heliocentric coordinates of Planet"<br>PRINT USING pr2$; "       X :"; xh<br>PRINT USING pr2$; "       Y :"; yh<br>PRINT USING pr2$; "       Z :"; zh<br>'<br>'   convert to geocentric rectangular coordinates<br>'<br>xg = xh - xe<br>yg = yh - ye<br>zg = zh<br>'<br>'   rotate around x axis from ecliptic to equatorial coords<br>'<br>ecl = 23.429292# * rads# 'value for J2000.0 frame<br>xeq = xg<br>yeq = yg * COS(ecl) - zg * SIN(ecl)<br>zeq = yg * SIN(ecl) + zg * COS(ecl)<br>'<br>'   find the RA and DEC from the rectangular equatorial coords<br>'<br>ra = FNatn2(yeq, xeq)<br>dec = ATN(zeq / SQR(xeq * xeq + yeq * yeq))<br>rvec = SQR(xeq * xeq + yeq * yeq + zeq * zeq)<br>PRINT<br>PRINT "Equatorial coordinates of planet"<br>PRINT USING pr$; "      RA : "; FNdegmin(ra * degs / 15)<br>PRINT USING pr$; "     DEC : "; FNdegmin(dec * degs)<br>PRINT USING pr2$; "Distance : "; rvec<br>END<br>'*********************************************************<br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">Below is a sample of the output of the program - the position of Mars for 0h UT 21st June 1997.</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">   year  : 1997<br>   month : 6<br>   day   : 21<br> hour UT : 0<br>  minute : 0<br>  planet : 4<br>    days :  -924.50<br><br>heliocentric coordinates of Earth<br>       X :  -0.005159<br>       Y :  -1.016252<br>       Z :   0.000000<br><br>heliocentric coordinates of Planet<br>       X :  -1.186699<br>       Y :  -1.031907<br>       Z :   0.007558<br><br>Equatorial coordinates of planet<br>      RA :    12.03<br>     DEC :     0.02<br>Distance :   1.181669<br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig10">Accuracy</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The<span>&nbsp;</span><code>QBASIC</code><span>&nbsp;</span>program
was modified to produce positions for the major panets over a 20 year
period centred on the date of the osculating elements used. The
resulting positions were saved to a file and loaded into a spreadsheet
long with values exported from Planeph 2.1, which was set to generate
positions referred to the 'mean ecliptic and equinox of J2000.0'. The
Error was defined as 'value from osculating elements - value from
Planeph'. Remember that the program uses an accurate iterative method
for finding the true anomalies of both the planet and Earth.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The results are shown in the table below. I forgot that my<span>&nbsp;</span><code>QBASIC</code><span>&nbsp;</span>program
was rounding the RA and DEC figures to three decimal places, so errors
smaller than 2 seconds or arcseconds could really be anywhere between 0
and 2 seconds/arcseconds!</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">Errors in RA in seconds of time<br><br>             +- 1 year     +- 3 years  +- 10 years<br>             RMS    Max     RMS   Max    RMS   Max<br>Mercury        3      8       5    18     17    60<br>Venus          2      4       8    31     27   135<br>Mars           2      4       5    15     26   130<br>Jupiter        1      2       1     4     16    50<br>Saturn         1      2       3    10     58   180<br>Uranus         1      2       1     3      8    20<br>Neptune        1      2       2     4      7    18<br>Pluto          1      2       2     5      6    13<br><br>Errors in DEC in arc-seconds<br><br>             +- 1 year     +- 3 years  +- 10 years<br>             RMS    Max     RMS   Max    RMS   Max<br>Mercury       15     38      21    70     69   258<br>Venus          7     15      37   158     98   639<br>Mars           8     17      24    80    145   832<br>Jupiter        3      8       4    11     75   265<br>Saturn         2      3      12    29    194   789<br>Uranus         2      4       4    15     41   114<br>Neptune        1      2       3     9     28    80<br>Pluto          2      4       5    15     33    83<br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
longer period planets (beyond Jupiter) may show larger errors for other
choices of element date - the 20 year time span here is only sampling
part of a typical orbit, and Saturn, Uranus and Neptune are strongly
perturbed by Jupiter.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">With
'peak to mean ratios' like those in the table, you might guess that a
time series graph of error against position date would show a complex
behaviour, not a simple monotonic rise with time from the date of the
elements. Looking at the plots of error against decimal year from the
date of the elements does indeed show a complex periodic structure.
Below are the plots for Mars.</p>
<h3 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Error time series graphs for Mars</h3>
<img src="http://www.stargazing.net/kepler/oscmar1.gif" alt="graph of RA error against year from date of elements" style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;" height="334" width="565"><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;"></span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The main features of the RA error time series for Mars are</p>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li>The curve is mostly flat, with narrow high 'peaks' which recur
after a period of about 2.2 years. The peaks are not quite symmetrical
about the date of the elements.</li><li>The 'peaks' are negative for
position dates before the date of the elements, and positive for
position dates after the date of the elements.</li><li>The 'peaks'
start small, and grow in size as the position date is further from the
element date, apart from the last pair of peaks.</li><li>The two peaks
at the largest times from the date of the elements (occuring at -8.87
and + 8.21 years) are slightly smaller than the preceeding one (at
-6.79 and + 6.02 years), so the amplitude of the peaks may be periodic.</li><li>The 'half width' of the larger peaks seems to be constant at about 0.3 years.</li><li>The maximum error (including the peaks) is less than 1 minute of time for position dates within 5 years of the element date.</li>
</ul>
<img src="http://www.stargazing.net/kepler/oscmar2.gif" alt="graph of DEC error against year from date of elements" style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;" height="334" width="565"><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;"></span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The main features of the DEC error time series for Mars are;</p>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li>Error is mostly flat with 'peaks' like the RA graph.</li><li>The peaks recur after a period of roughly 2.2 years, and the peaks co-incide with the peaks in RA error.</li><li>The
peaks are more complex in structure, and are preceeded by smaller
'dips' - as if there is another periodic error term causing
'destructive intereference'. The two peaks furthest from the element
date show this very clearly.</li><li>The polarity of the peaks seems to
change - as the position date is set further ahead of the element date,
the first two peaks are small and negative in sign, then the next two
are large and positive in sign. The pattern is the same but inverted
for position dates before the element date.</li><li>The maximum error (including the peaks) is less than 5 minutes of arc for 5 years either side of the date of the elements.</li>
</ul>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig11">Books</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/ellipse.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Below
is a list of the books which I have used in compiling this page. These
books should be found in most University libraries in English speaking
countries.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Duffett-Smith, Peter<br><cite>Practical Astronomy with your calculator</cite><br>Cambridge University Press<br>3rd edition 1988<br>ISBN 0-521-35699-7</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Kuhn, Thomas S<br>The Structure of Scientific Revolutions<br>2nd Ed, 1972<br>University of Chicago Press<br>ISBN 0-226-45804-0</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Meeus, Jean<br><cite>Astronomical Algorithms</cite><br>Willmann-Bell<br>1st English edition, 1991<br>ISBN 0-943396-35-2</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">[<a href="http://www.stargazing.net/kepler/index.html">Root</a>]</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Last Modified 26th July 1998<br>Corrected a problem with the equation of centre formula, pointed out by Donald Thompson.<br>Keith Burnett<br></p>
<address style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">keith@xylem.demon.co.uk</address>
<br class="Apple-interchange-newline">


</body></html>