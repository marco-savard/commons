<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head><meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>sun</title></head><body><img src="http://www.stargazing.net/kepler/banner.gif" alt="" style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;" border="0" height="30" width="400"><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;"></span>
<h1 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig00">Position of the Sun</a></h1>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/index.html" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Root</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Contents</h2>
<ul style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">
<li><a href="http://www.stargazing.net/kepler/sun.html#twig01">Overview</a></li><li><a href="http://www.stargazing.net/kepler/sun.html#twig02">The formulas with typical values</a></li><li><a href="http://www.stargazing.net/kepler/sun.html#twig03">QBASIC program</a></li><li><a href="http://www.stargazing.net/kepler/sun.html#twig04">Accuracy over 100 years</a></li>
</ul>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig01">Overview</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/sun.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">This page is based on page C24 of the 1996<span>&nbsp;</span><cite>Astronomical Almanac</cite><span>&nbsp;</span>which
provides a method for finding the position of the Sun in the sky to an
accuracy of 0.01 degree between the years 1950 and 2050.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">The
formulas are based on an elliptical orbit for the Earth, using mean
orbital elements and a two term approximation for the 'equation of
centre'. There is also an approximate allowance made for the change in
obliquity of the ecliptic with time, needed when converting to right
ascension and declination. The positions are thus<span>&nbsp;</span><em>apparent</em><span>&nbsp;</span>positions, they are referred to the mean ecliptic and equinox of date.</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I
compared the positions found using this low precision formula with
values referred to the mean ecliptic and equinox of date from a more
accurate program. The results (for the whole 1950 to 2050 range) are
summarised below. I found the series to be accurate within 3 seconds of
RA and 15 arc seconds in declination.</p>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig02">The formulas with typical values</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/sun.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Below, I give the formulas from page C24 of the<span>&nbsp;</span><cite>Astronomical Almanac</cite>,
with modified notation. I have given the formulas together with
numerical values for a specific day. The calculations were done on a
normal scientific calculator with 8 figure accuracy.</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">Position of the Sun at 11:00 UT on 1997 August 7th<br><br>1. Find the days before J2000.0 (d) from the <a href="http://www.stargazing.net/kepler/days.txt">table</a><br><br>   d = 11/24 + 212 + 7 - 1096.5 = -877.04167<br><br>2. Find the Mean Longitude (L) of the Sun<br><br>   L = 280.461 + 0.9856474 * d<br>     = -583.99284 + 720  <br>    (add multiples of 360 to bring in range 0 to 360)<br>     = 136.00716<br><br>3. Find the Mean anomaly (g) of the Sun<br><br>   g = 357.528 + 0.9856003 * d<br>     = -506.88453 + 720<br>     = 213.11547<br><br>4. Find the ecliptic longitude (lambda) of the sun<br><br>   lambda = L + 1.915 * sin(g) + 0.020 * sin(2*g)<br>          = 134.97925<br><br>   (note that the sin(g) and sin(2*g) terms constitute an <br>    approximation to the 'equation of centre' for the orbit <br>    of the Sun)<br><br>   beta = 0 (by definition as the Sun's orbit defines the<br>             ecliptic plane. This results in a simplification<br>             of the formulas below)<br><br>5. Find the obliquity of the ecliptic plane (epsilon)<br><br>   epsilon = 23.439 - 0.0000004 * d<br>           = 23.439351<br><br>6. Find the Right Ascension (alpha) and Declination (delta) of<br>   the Sun<br><br>   Y = cos(epsilon) * sin(lambda)<br>   X = cos(lambda)<br><br>   a = arctan(Y/X)<br><br>   If X &lt; 0 then alpha = a + 180<br>   If Y &lt; 0 and X &gt; 0 then alpha = a + 360<br>   else alpha = a<br><br>   Y =  0.6489924<br>   X = -0.7068507<br><br>   a = -42.556485<br>   alpha = -42.556485 + 180 = 137.44352 (degrees)<br>   <br>   delta = arcsin(sin(epsilon)*sin(lambda))<br>         = 16.342193 degrees<br><br>Final result<br><br>   Right ascension is usually given in hours of time, and both<br>   figures need to be rounded to a sensible number of decimal<br>   places. <br><br><br>   alpha =   9.163 hrs      or   9h 09m 46s<br>   delta = +16.34 degrees   or +16d 20' 32"<br><br>   The Interactive Computer Ephemeris gives<br><br>   alpha =   9h 09m 45.347s and<br>   delta = +16d 20' 30.89"  <br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig03">QBASIC program</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/sun.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">'*********************************************************<br>'   This program will calculate the position of the Sun<br>'   using a low precision method found on page C24 of the<br>'   1996 Astronomical Almanac.<br>'<br>'   The method is good to 0.01 degrees in the sky over the<br>'   period 1950 to 2050.<br>'<br>'   QBASIC program by Keith Burnett (kburnett@geocity.com)<br>'<br>'<br>'   Work in double precision and define some constants<br>'<br>DEFDBL A-Z<br>pr1$ = "\         \#####.##"<br>pr2$ = "\         \#####.#####"<br>pr3$ = "\         \#####.###"<br>pi = 4 * ATN(1)<br>tpi = 2 * pi<br>twopi = tpi<br>degs = 180 / pi<br>rads = pi / 180<br>'<br>'   Get the days to J2000<br>'   h is UT in decimal hours<br>'   FNday only works between 1901 to 2099 - see Meeus chapter 7<br>'<br>DEF FNday (y, m, d, h) = 367 * y - 7 * (y + (m + 9) \ 12) \ 4 + 275 * m \ 9 + d - 730531.5 + h / 24<br>'<br>'   define some arc cos and arc sin functions and a modified inverse<br>'   tangent function<br>'<br>DEF FNacos (x)<br>    s = SQR(1 - x * x)<br>    FNacos = ATN(s / x)<br>END DEF<br>DEF FNasin (x)<br>    c = SQR(1 - x * x)<br>    FNasin = ATN(x / c)<br>END DEF<br>'<br>'   the atn2 function below returns an angle in the range 0 to two pi<br>'   depending on the signs of x and y.<br>'<br>DEF FNatn2 (y, x)<br>    a = ATN(y / x)<br>    IF x &lt; 0 THEN a = a + pi<br>    IF (y &lt; 0) AND (x &gt; 0) THEN a = a + tpi<br>    FNatn2 = a<br>END DEF<br>'<br>'   the function below returns the true integer part,<br>'   even for negative numbers<br>'<br>DEF FNipart (x) = SGN(x) * INT(ABS(x))<br>'<br>'   the function below returns an angle in the range<br>'   0 to two pi<br>'<br>DEF FNrange (x)<br>    b = x / tpi<br>    a = tpi * (b - FNipart(b))<br>    IF a &lt; 0 THEN a = tpi + a<br>    FNrange = a<br>END DEF<br>'<br>'   Find the ecliptic longitude of the Sun<br>'<br>DEF FNsun (d)<br>'<br>'   mean longitude of the Sun<br>'<br>L = FNrange(280.461 * rads + .9856474# * rads * d)<br>'<br>'   mean anomaly of the Sun<br>'<br>g = FNrange(357.528 * rads + .9856003# * rads * d)<br>'<br>'   Ecliptic longitude of the Sun<br>'<br>FNsun = FNrange(L + 1.915 * rads * SIN(g) + .02 * rads * SIN(2 * g))<br>'<br>'   Ecliptic latitude is assumed to be zero by definition<br>'<br>END DEF<br>'<br>'<br>'<br>CLS<br>'<br>'    get the date and time from the user<br>'<br>INPUT "  year  : ", y<br>INPUT "  month : ", m<br>INPUT "  day   : ", day<br>INPUT "hour UT : ", h<br>INPUT " minute : ", mins<br>h = h + mins / 60<br>d = FNday(y, m, day, h)<br>'<br>'   Use FNsun to find the ecliptic longitude of the<br>'   Sun<br>'<br>lambda = FNsun(d)<br>'<br>'   Obliquity of the ecliptic<br>'<br>obliq = 23.439 * rads - .0000004# * rads * d<br>'<br>'   Find the RA and DEC of the Sun<br>'<br>alpha = FNatn2(COS(obliq) * SIN(lambda), COS(lambda))<br>delta = FNasin(SIN(obliq) * SIN(lambda))<br>'<br>'   Find the Earth - Sun distance<br>'<br>r = 1.00014 - .01671 * COS(g) - .00014 * COS(2 * g)<br>'<br>'   Find the Equation of Time<br>'<br>equation = (L - alpha) * degs * 4<br>'<br>'   print results in decimal form<br>'<br>PRINT<br>PRINT "Position of Sun"<br>PRINT "==============="<br>PRINT<br>PRINT USING pr2$; "     days : "; d<br>PRINT USING pr1$; "longitude : "; lambda * degs<br>PRINT USING pr3$; "       RA : "; alpha * degs / 15<br>PRINT USING pr1$; "      DEC : "; delta * degs<br>PRINT USING pr2$; " distance : "; r<br>PRINT USING pr1$; "eq time   : "; equation<br>END<br>'*********************************************************<br><br></pre>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">Below is the output from the program when run for 11:00 UT on 1997 August 7.</span>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">  year  : 1997<br>  month : 8<br>  day   : 7<br>hour UT : 11<br> minute : 0<br><br>Position of Sun<br>===============<br><br>     days : -877.04167<br>longitude :  134.98<br>       RA :    9.163<br>      DEC :   16.34<br> distance :    1.01408<br>eq time   :   -5.75<br><br></pre>
<h2 style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-style: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;"><a name="twig04">Accuracy over 100 year period</a></h2>
<span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">[</span><a href="http://www.stargazing.net/kepler/sun.html#twig00" style="font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Top</a><span style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: rgb(255, 255, 255); display: inline ! important; float: none;">]</span>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">I modified the<span>&nbsp;</span><code>QBASIC</code><span>&nbsp;</span>program
above to produce a file of positions for days from -20,000 to +20,000 -
a 106 year period centred on J2000.0. The RA and DEC figures were
rounded to 4 places of decimals in this file. I used Planeph to
generate a similar file of positions for the Sun, referred to the mean
ecliptic and equinox of date. I then loaded both files into a
spreadsheet, and found the errors in seconds of time (RA) and
arcseconds (DEC). The maximum and minimum errors are shown in the table
below for various ranges of time about J2000.0</p>
<pre style="color: rgb(0, 0, 0); font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px;">Sun error	<br>                    RA sec    DEC arcsec<br>Max within 3 year     0.6        8.9<br>Min within 3 year    -2.1       -8.2<br>Max within 10 year    0.6       10.9<br>Min within 10 year   -2.6      -12.5<br>Max within 50 year    1.0       16.8<br>Min within 50 year   -2.9      -16.1<br><br>Error = C24 low precision method - Planeph<br><br>Note: Planeph was set to give output referred to mean <br>      ecliptic and equinox of date.<br><br></pre>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">[<a href="http://www.stargazing.net/kepler/index.html">Root</a>]</p>
<p style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-style: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">Last Modified 7th August 1997<br>Keith Burnett<br></p>
<address style="color: rgb(0, 0, 0); font-family: &quot;Times New Roman&quot;; font-size: medium; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px;">keith@xylem.demon.co.uk</address>
<br class="Apple-interchange-newline">

  

</body></html>